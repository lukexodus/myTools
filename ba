#!/usr/bin/env python3
# ba [Bullet Point Adder] - Adds bullet points to the start of each line of text on the clipboard.

# Made for Linux (Windows version commented out below)

import subprocess

# ========== ORIGINAL WINDOWS VERSION (COMMENTED OUT) ==========
# import pyperclip
#
# text = pyperclip.paste()  # gets the text in the clipboard
#
# # Separate lines and add stars.
# lines = text.split("\n")
#
# for i in range(len(lines)):  # loop through all indexes for "lines" list
#     lines[i] = "* " + lines[i]  # add star to each string in "lines" list
# text = "\n".join(lines)  # joins the list values into a string, seperated by '\n'
# pyperclip.copy(text)  # puts the processed text into the clipboard
# ===============================================================


# ========== LINUX VERSION (using wl-clipboard) ==========
def get_clipboard():
    """Get clipboard content using wl-paste"""
    try:
        result = subprocess.run(['wl-paste'], capture_output=True, text=True, check=True)
        return result.stdout
    except (subprocess.CalledProcessError, FileNotFoundError):
        print("Error: Could not read clipboard. Install wl-clipboard: sudo pacman -S wl-clipboard")
        return ""


def set_clipboard(text):
    """Set clipboard content using wl-copy"""
    try:
        subprocess.run(['wl-copy'], input=text, text=True, check=True)
        return True
    except (subprocess.CalledProcessError, FileNotFoundError):
        print("Error: Could not write to clipboard.")
        return False


if __name__ == "__main__":
    text = get_clipboard()
    if not text:
        exit(1)
    
    # Strip trailing newline added by wl-paste
    text = text.rstrip('\n')
    
    # Separate lines and add bullet points
    lines = text.split("\n")
    
    for i in range(len(lines)):
        lines[i] = "* " + lines[i]
    
    text = "\n".join(lines)
    
    if set_clipboard(text):
        print(f"âœ“ Added bullet points to {len(lines)} lines")
    else:
        exit(1)
